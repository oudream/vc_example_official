<!--TO READ THIS HELP FILE, RIGHT-CLICK ON THE FILE NAME IN THE
    SOLUTION EXPLORER PANE AND SELECT "VIEW IN BROWSER"-->

<html><head><title>ALLINONE Sample: Implements a Server Using ATL, Exposing STL Collections, Controlled by Compiler COM Support in an MFC Application</title></head><body><h1>ALLINONE Sample: Implements a Server Using ATL, Exposing STL Collections, Controlled by Compiler COM Support in an MFC Application</h1><div id="mainSection"><div id="mainBody"><div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()"></div><p /><p>This sample demonstrates the ability of ATL, STL, Visual C++ compiler COM support, and MFC to coexist in a single application. Building on the <MSHelp:link keywords="FBB3F91E-E1A4-4B44-BCAB-7A3C0503EF4D" tabindex="0" >COLLECT MFC sample</MSHelp:link>, nine collections are implemented in STL by using map, multimap, list, vector, deque, and set. They are exposed as custom interfaces by using ATL with multiple types of aggregation. The MFC controller uses compiler COM support.</p><p>Compare this sample with the <MSHelp:link keywords="FBB3F91E-E1A4-4B44-BCAB-7A3C0503EF4D" tabindex="0" >COLLECT MFC sample</MSHelp:link>.</p><div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left">Security Note </th></tr><tr><td><p>This sample code is provided to illustrate a concept and should not be used in applications or Web sites, as it may not illustrate the safest coding practices.</p></td></tr></table></div><h1 class="heading">Building and Running the Sample</h1><div id="sectionSection0" class="seeAlsoNoToggleSection"><div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left">Note </th></tr><tr><td><p>If you are running Visual C++ Express Edition, you might need to install the Platform SDK before running this sample. For information on how to do this, see <MSHelp:link keywords="971463b4-7178-42cc-87b4-566295b7ae50" tabindex="0" >How to: Use Visual C++ Express Edition with the Microsoft Platform SDK</MSHelp:link>.</p></td></tr></table></div><h4 class="subHeading">To build and run this sample</h4><div class="subSection"><ol><li><p>Open the solution AllInOne.sln. </p></li><li><p>On the <b>Build</b> menu, click <b>Build Solution</b>.</p></li><li><p>Press F5 to run the sample.</p></li><li><p>In the sample's user interface, select and use a collection class from the <b>Example</b> menu.</p></li></ol></div></div><h1 class="heading">Keywords</h1><div id="sectionSection1" class="seeAlsoNoToggleSection"><p>This sample demonstrates the following keywords:</p><p>map, vector, set, multimap, list, deque, _com_ptr_t, _bstr_t, _com_error</p></div></div><div id="footer"><div class="footerLine"></div>
          © Microsoft Corporation. All rights reserved.  Send <a href="mailto:DevDocs@microsoft.com?subject=Documentation Feedback :ALLINONE Sample: Implements a Server Using ATL, Exposing STL Collections, Controlled by Compiler COM Support in an MFC Application">comments</a> about this topic to Microsoft.
      </div></div></body></html>
