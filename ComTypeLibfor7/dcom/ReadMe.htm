<!--TO READ THIS HELP FILE, RIGHT-CLICK ON THE FILE NAME IN THE
    SOLUTION EXPLORER PANE AND SELECT "VIEW IN BROWSER"-->

<html><head><title>DCOM Sample: Calls COM Object in Windows NT Service from Multiple Clients</title></head><body><h1>DCOM Sample: Calls COM Object in Windows NT Service from Multiple Clients</h1><div id="mainSection"><div id="mainBody"><div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()"></div><p /><p>The DCOM sample demonstrates how to call a COM object implemented in a Windows service from multiple clients running on different computers. It is composed of several parts:   </p><ul><li><p><b>DrawServ</b>   The Windows service that implements the COM object.</p></li><li><p><b>ATLDraw</b>   The client that connects to the DrawServ COM object. </p></li><li><p><b>DrawCtl</b>   A control version of ATLDraw. It has a Connect method (that takes a machine name string parameter), a Disconnect method, and a Clear method.</p></li><li><p><b>MFCCont</b>   An MFC container for DrawCtl. Enter the name of the (possibly remote) server without quotes or slashes.</p></li><li><p><b>ATLCont</b>   An ATL container for DrawCtl. Enter the name of the (possibly remote) server without quotes or slashes.</p></li></ul><p>All computers must be running Windows NT 4.0 or later for this sample to work.</p><p>Compare this sample with the ATL <MSHelp:link keywords="FF3860A8-9FD8-4D89-B5EE-92A938BF90E2" tabindex="0" >DCOM sample</MSHelp:link>.</p><div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left">Security Note </th></tr><tr><td><p>This sample code is provided to illustrate a concept and should not be used in applications or Web sites, as it may not illustrate the safest coding practices.</p></td></tr></table></div><h1 class="heading">Building and Running the Sample</h1><div id="sectionSection0" class="seeAlsoNoToggleSection"><div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left">Note </th></tr><tr><td><p>If you are running Visual C++ Express Edition, you might need to install the Platform SDK before running this sample. For information on how to do this, see <MSHelp:link keywords="971463b4-7178-42cc-87b4-566295b7ae50" tabindex="0" >How to: Use Visual C++ Express Edition with the Microsoft Platform SDK</MSHelp:link>.</p></td></tr></table></div><h4 class="subHeading">To build and run this sample</h4><div class="subSection"><ol><li><p>Open the solution dcom.sln.</p></li><li><p>Build the DrawServ and ATLDraw samples.</p></li><li><p>Copy Drawserv.exe and Atldraw.exe to each computer that you want to run the sample from. Register the server on each computer by running DrawServ with the command-line argument /RegServer or -RegServer (case-insensitive). For example: </p><div class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><td colspan="2"><pre>DrawServ /RegServer</pre></td></tr></table></span></div><p>(Register.dll must be registered for this to work.) The reason you need to copy the server to each client is that the CLSID for the server and the server type library need to be registered on the client. </p></li><li><p>Start the service on the server by using the Services icon in Control Panel.</p></li><li><p>Using DCOMCNFG on each client, select the Properties of the DrawServ Class. From the <b>Location</b> tab, select <b>Run application on the following computer</b>, then enter the name of the computer on which you are running the server object. Clear the <b>Run application on this computer</b> check box.</p></li><li><p>Run ATLDraw and select Server. Connect from the menu on each client. Draw on the client window by holding the left mouse button down and dragging a line. The drawn line should appear on each client that is also connected to the same server. You can also use the <b>Color</b> command from the <b>View</b> menu to change the color for each client.</p></li><li><p>If there is any problem connecting to a remote server (for example, if Tstcon32.exe does not call CoInitializeSecurity), run DCOMCNFG on the client and open the tab <b>Default Properties</b>. Set <b>Default Authentication Level</b> to None and <b>Default Impersonation Level</b> to Anonymous.</p></li></ol></div></div></div><div id="footer"><div class="footerLine"></div>
          © Microsoft Corporation. All rights reserved.  Send <a href="mailto:DevDocs@microsoft.com?subject=Documentation Feedback :DCOM Sample: Calls COM Object in Windows NT Service from Multiple Clients">comments</a> about this topic to Microsoft.
      </div></div></body></html>
