<!--TO READ THIS HELP FILE, RIGHT-CLICK ON THE FILE NAME IN THE
    SOLUTION EXPLORER PANE AND SELECT "VIEW IN BROWSER"-->

<html><head><title>MFCCALC Sample: Demonstrates an Automation Server Application (C++ Samples)</title></head><body><h1>MFCCALC Sample: Demonstrates an Automation Server Application (C++ Samples)</h1><div id="mainSection"><div id="mainBody"><div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()"></div><p /><p>MFCCALC is an Automation server. It implements a simple calculator similar to the CALC application in Windows. It can be driven via Automation by running its CalcDriv project, or it can be run standalone by running its MfcCalc project.</p><p>This sample is similar to the MFC samples MFCCALC and CALCDRIV except that it uses the native compiler COM support and it combines the calculator and driver in a single sample. </p><div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left">Security Note </th></tr><tr><td><p>This sample code is provided to illustrate a concept and should not be used in applications or Web sites, as it may not illustrate the safest coding practices.</p></td></tr></table></div><h1 class="heading">Building and Running the Sample</h1><div id="sectionSection0" class="seeAlsoNoToggleSection"><div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left">Note </th></tr><tr><td><p>If you are running Visual C++ Express Edition, you might need to install the Platform SDK before running this sample. For information on how to do this, see <MSHelp:link keywords="971463b4-7178-42cc-87b4-566295b7ae50" tabindex="0" >How to: Use Visual C++ Express Edition with the Microsoft Platform SDK</MSHelp:link>.</p></td></tr></table></div><h4 class="subHeading">To build and run this sample</h4><div class="subSection"><ol><li><p>Open the solution mfccalc.sln.</p></li><li><p>On the <b>Build</b> menu, click <b>Build Solution</b>.</p></li><li><p>Set MfcCalc as the startup project (right-click the project node and click <b>Set as StartUp Project</b>).</p></li><li><p>On the <b>Debug</b> menu, click <b>Start Without Debugging</b>. This will run the calculator standalone. Close the MfcCalc application before continuing.</p></li><li><p>Now run the calculator using Automation. Set CalcDriv as the startup project and click <b>Start Without Debugging</b>. Type an expression in the <b>MFC Calc Driver</b> dialog box and click the <b>Go</b> button to run the calculator.</p></li></ol></div></div><h1 class="heading">Comparison with the MFC Version</h1><div id="sectionSection1" class="seeAlsoNoToggleSection"><p>For more information, see the corresponding MFC samples <MSHelp:link keywords="DDABA58D-875D-42D9-8CBF-6D97507A03ED" tabindex="0" >MFCCALC</MSHelp:link> and <MSHelp:link keywords="1A489632-8C9C-4CDA-B014-C60713B348CD" tabindex="0" >CALCDRIV</MSHelp:link>.</p><p>The differences between this sample and the MFC samples:  </p><ul><li><p>The <b>COleDispatchDriver</b> class is no longer necessary. Instead, <b>#import</b> is used to import a type library.</p></li><li><p><b>_bstr_t</b> and <b>_variant_t</b> wrapper classes are used to simplify operations of <b>BSTR</b> and <b>VARIANT</b> types.</p></li><li><p><b>__declspec(property)</b> is used to simplify assignment operations for properties of COM objects.</p></li><li><p>COM error handling is now performed by using the <b>_com_error</b> class.</p></li></ul><p>With the Visual C++ native compiler COM support, the resulting sample code is shorter and more efficient. The MFC-based MFCCALC sample uses dispinterfaces only. Compare this sample with the MFC version to see the differences in source code.</p></div><h1 class="heading">Keywords</h1><div id="sectionSection2" class="seeAlsoNoToggleSection"><p>This sample demonstrates the following keywords:</p><p>dispinterface; #import; _com_ptr_t; _variant_t; _bstr_t; _com_error</p></div></div><div id="footer"><div class="footerLine"></div>
          © Microsoft Corporation. All rights reserved.  Send <a href="mailto:DevDocs@microsoft.com?subject=Documentation Feedback :MFCCALC Sample: Demonstrates an Automation Server Application (C++ Samples)">comments</a> about this topic to Microsoft.
      </div></div></body></html>
