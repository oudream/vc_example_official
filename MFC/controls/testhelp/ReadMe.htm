<!--TO READ THIS HELP FILE, RIGHT-CLICK ON THE FILE NAME IN THE
    SOLUTION EXPLORER PANE AND SELECT "VIEW IN BROWSER"-->

<html><head><title>TESTHELP Sample: ActiveX Control with Tooltips and Help</title></head><body><h1>TESTHELP Sample: ActiveX Control with Tooltips and Help</h1><div id="mainSection"><div id="mainBody"><div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()"></div><p /><p>The TESTHELP sample demonstrates how to use MFC to build an ActiveX control that has its own help file to display help for the user. Testhelp.ocx also shows how to add tooltips to an MFC ActiveX control. </p><div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left">Security Note </th></tr><tr><td><p>This sample code is provided to illustrate a concept and should not be used in applications or Web sites, as it may not illustrate the safest coding practices.</p></td></tr></table></div><h1 class="heading">Building and Running the Sample</h1><div id="sectionSection0" class="seeAlsoNoToggleSection"><h4 class="subHeading">To build and run the TESTHELP sample</h4><div class="subSection"><ol><li><p>Open the solution Testhelp.sln.</p></li><li><p>On the <b>Build</b> menu, click <b>Build</b>.</p></li></ol></div><p>After you have built the TESTHELP sample, you will be able to use it in any ActiveX container application. See <MSHelp:link keywords="626867CF-FE53-4C30-8973-55BB93EF3917" tabindex="0" >Testing Properties and Events with Test Container</MSHelp:link> for information on how to access the test container. Include the TESTHELP control in your container's project and run the project. You can set the properties of the TESTHELP control by opening the property dialog of your container.</p><p>The Help project file and all Help project's source files are also included in this sample.</p><h4 class="subHeading">To rebuild and run the TESTHELP help file</h4><div class="subSection"><ol><li><p>From the <b>Start</b> menu, click <b>Help Workshop</b>.</p></li><li><p>Open Testhelp.hpj. Help Workshop displays a wizard to convert the file into an .hhp file. Run the wizard, naming the file and accepting the changes.</p></li><li><p>Click <b>Compile</b> on the <b>File</b> menu. In the <b>Create a compiled file dialog box</b>, indicate where you want to store the compiled file, and then click <b>Compile</b>.</p></li><li><p>To view the compiled file, click <b>Compiled Help File </b>on the <b>View</b> menu.</p></li></ol></div></div><h1 class="heading">TESTHELP Features</h1><div id="sectionSection1" class="seeAlsoNoToggleSection"><p>TESTHELP demonstrates how to:  </p><ul><li><p>Display a tooltip for your ActiveX control.</p></li><li><p>Toggle the tooltip on and off using the control's property page.</p></li><li><p>Change the tooltip's text using the control's property page.</p></li><li><p>Enable the ActiveX control container's property frame Help button to display the control's help file when the Help button is clicked.</p></li><li><p>Enable the "?" button in Visual C++'s Component and Controls Gallery so that the control's help file will be displayed when this control is chosen from the Gallery and the "?" button is clicked.</p></li><li><p>Display help at run time when the control has the keyboard focus and F1 is pressed.</p></li><li><p>Use the Font, BackColor, and ForeColor stock properties of an ActiveX control.</p></li></ul></div><h1 class="heading">General Property Page</h1><div id="sectionSection2" class="seeAlsoNoToggleSection"><dl><dt><b>Type of Help to Use</b></dt><dd><p>This property determines how help will be used when the user presses F1 while the TESTHELP control has the keyboard focus. Help in a pop-up window means that when the user presses F1 while the TESTHELP control is running in a container and has the keyboard focus, a pop-up window with the "What is this thing?" topic from the Testhelp.hlp helpfile is displayed. Show the Whole Help File means that when the user presses F1 while the TESTHELP control is running in a container and has the keyboard focus, the entire Windows help program will come up displaying the contents topic of the Testhelp.hlp file.</p></dd></dl><dl><dt><b>Use Control's Help File</b></dt><dd><p>When this box is checked, help will be displayed in the format determined by the Type of Help to Use property when the user presses F1 while the control is running in a container and has the keyboard focus.</p></dd></dl><dl><dt><b>Use ToolTip for this Control</b></dt><dd><p>If this box is checked, a tooltip will be displayed over the control's window if the control is running in the container and the mouse cursor moves into and stops in the control's window. The text to be displayed is determined by the Tooltip Caption property.</p></dd></dl><dl><dt><b>Tooltip Caption</b></dt><dd><p>This is the text to be displayed in a tooltip if the user chooses to show tooltips.</p><ul><li><p>Name1   The name displayed at the top of the control.</p></li><li><p>Name2   The name displayed in the middle of the control.</p></li><li><p>Name3   The name displayed at the bottom of the control.</p></li></ul></dd></dl></div><h1 class="heading">Color Property Page</h1><div id="sectionSection3" class="seeAlsoNoToggleSection"><p>Lets the user select colors to be used in painting this control.</p></div><h1 class="heading">Font Property Page</h1><div id="sectionSection4" class="seeAlsoNoToggleSection"><p>Lets the user specify the font used for the text on the control.</p><div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left">Note </th></tr><tr><td><p>Some samples, such as this one, have not been modified to reflect the changes in the Visual C++ wizards, libraries, and compiler, but still demonstrate how to complete your desired task. </p></td></tr></table></div><sections ><h4 class="subHeading" xmlns="">Keywords</h4><div class="subSection" xmlns=""><p>The TESTHELP sample demonstrates the following classes and keywords:</p><p>CToolTipCtrl; COleControl::OnDraw; COleControl::OnResetState; COlePropertyPage::OnHelp</p><div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left">Note </th></tr><tr><td><p>Some samples, such as this one, have not been modified to reflect the changes in the Visual C++ wizards, libraries, and compiler, but still demonstrate how to complete your desired task. </p></td></tr></table></div></div></sections></div></div><div id="footer"><div class="footerLine"></div>
          © Microsoft Corporation. All rights reserved.  Send <a href="mailto:DevDocs@microsoft.com?subject=Documentation Feedback :TESTHELP Sample: ActiveX Control with Tooltips and Help">comments</a> about this topic to Microsoft.
      </div></div></body></html>
