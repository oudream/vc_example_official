<!--TO READ THIS HELP FILE, RIGHT-CLICK ON THE FILE NAME IN THE
    SOLUTION EXPLORER PANE AND SELECT "VIEW IN BROWSER"-->

<html><head><title>CALCDRIV Sample: Demonstrates an Automation Client Application</title></head><body><h1>CALCDRIV Sample: Demonstrates an Automation Client Application</h1><div id="mainSection"><div id="mainBody"><div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()"></div><p /><p>The CALCDRIV sample is a simple Automation (formerly OLE Automation) client application. CALCDRIV drives the MFCCALC sample application, which is an Automation server that provides basic calculator functions. MFCCALC has a simple calculator interface that looks like the Calculator application that comes with Microsoft Windows.</p><div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left">Security Note </th></tr><tr><td><p>This sample code is provided to illustrate a concept and should not be used in applications or Web sites, as it may not illustrate the safest coding practices.</p></td></tr></table></div><h1 class="heading">Building and Running the Sample</h1><div id="sectionSection0" class="seeAlsoNoToggleSection"><h4 class="subHeading">To build and run the CALCDRIV sample</h4><div class="subSection"><ol><li><p>Follow the instructions in MFCCALC to build and run that project.</p></li><li><p>Open the solution calcdriv.sln</p></li><li><p>On the <b>Build</b> menu, click <b>Build</b>. </p><div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left">Note </th></tr><tr><td><p>If you do not build and register MFCCALC before building CALCDRIV, you get an "Unable to create 'MFCCALC.Application' object" message.</p></td></tr></table></div></li></ol></div><p>When you run CALCDRIV, the Microsoft Foundation Class Library (MFC) <b>Calc Driver</b> dialog box appears and the MFCCALC application is launched. You can use MFCCALC's calculator user interface directly at this point, or you can drive MFCCALC from CALCDRIV as follows:  </p><ol><li><p>In MFC Calc Driver's <b>Expression</b> box, provide two or more numbers separated by the operator +, -, *, or /.  </p><div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left">Note </th></tr><tr><td><p>MFCCALC does not interpret parentheses and does not implement operator precedence.</p></td></tr></table></div></li><li><p>Click <b>Go</b> to have MFCCALC evaluate the expression in one step.</p></li><li><p>Click <b>Single Step</b> to step through the expression one number or operator at a time.</p></li><li><p>Click <b>Refresh</b> to request state information for MFCCALC (<b>Last Accum </b>and <b>Last Operand</b>).</p></li></ol></div><h1 class="heading">Using a Dispatch Class</h1><div id="sectionSection1" class="seeAlsoNoToggleSection"><p>CALCDRIV uses the <b>CRemoteCalcDlg</b> class as follows:  </p><ul><li><p>The <b>CRemoteCalcDlg</b> class of CALCDRIV represents the dispatch interface of MFCCALC. Class <b>CRemoteCalcDlg</b> is derived from <b>CCmdTarget</b>, which has a few automation-specific member functions, such as <b>CreateDispatch</b>.</p></li><li><p><b>CDriverDlg</b> embeds a <b>CRemoteCalcDlg</b> object, <code>m_calc</code>. The <b>CRemoteCalcDlg</b> object, like the <code>CDriverDlg</code> object in which it is embedded, is alive for most of the duration of CALCDRIV. The <b>CRemoteCalcDlg</b> is constructed when the dialog object is constructed.</p></li><li><p><b>CDriverDlg::OnInitDialog</b> calls <b>CCmdTarget::CreateDispatch</b> for the <b>CRemoteCalcDlg</b> object. <b>CreateDispatch</b> requires the dispatch name as the first parameter. Typically, the developer of an automation server application provides documentation describing the names of the dispatch interfaces and the properties and methods of the interfaces. Another way to find the names of the dispatch interfaces of an automation server application is to look at the server's Windows registration, using REGEDIT /v (the verbose option).</p></li><li><p><b>CDriverDlg</b> implements CALCDRIV's expression evaluator by calling the <code>Button</code> method of MFCCALC, which is an emulator for the various buttons in the calculator's dialog box.</p></li><li><p><b>CDriverDlg</b> implements CALCDRIV's <code>Refresh</code> function by calling the <code>GetOpnd</code> and <code>GetAccum</code> methods of MFCCALC.</p></li><li><p>The <b>CDriverDlg</b> destructor calls the <code>Quit</code> method exposed by MFCCALC to shut down MFCCALC when CALCDRIV closes. </p></li></ul></div><h1 class="heading">Keywords</h1><div id="sectionSection2" class="seeAlsoNoToggleSection"><p>This sample demonstrates the following keywords:</p><p>AfxMessageBox; AfxOleInit; CDialog::DoModal; CDialog::EndDialog; CDialog::OnInitDialog; CEdit::GetSel; CEdit::SetSel; COleDispatchDriver::AttachDispatch; COleDispatchDriver::CreateDispatch; COleDispatchDriver::GetProperty; COleDispatchDriver::InvokeHelper; COleDispatchDriver::SetProperty; CString::GetLength; CWinApp::InitInstance; CWnd::DoDataExchange; CWnd::GetWindowText; CWnd::SetWindowText; GetWindowText; afxMemDF; min; wsprintf</p><div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left">Note </th></tr><tr><td><p>Some samples, such as this one, have not been modified to reflect the changes in the Visual C++ wizards, libraries, and compiler, but still demonstrate how to complete your desired task. </p></td></tr></table></div></div></div><div id="footer"><div class="footerLine"></div>
          © Microsoft Corporation. All rights reserved.  Send <a href="mailto:DevDocs@microsoft.com?subject=Documentation Feedback :CALCDRIV Sample: Demonstrates an Automation Client Application">comments</a> about this topic to Microsoft.
      </div></div></body></html>
