<!--TO READ THIS HELP FILE, RIGHT-CLICK ON THE FILE NAME IN THE
    SOLUTION EXPLORER PANE AND SELECT "VIEW IN BROWSER"-->

<html><head><title>MEDriver Sample: Demonstrates COM Eventing in the .NET Framework</title></head><body><h1>MEDriver Sample: Demonstrates COM Eventing in the .NET Framework</h1><div id="mainSection"><div id="mainBody"><div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()"></div><p /><p>The MEDriver sample illustrates the use of COM events (fired from an unmanaged COM server) through a .NET Framework wrapper, automatically generated from the COM server's type library.</p><p>MEDriver is implemented as a Windows Forms application. It uses the ATL sample <MSHelp:link keywords="E7FF3A37-A0ED-4578-A0A8-DF072817BA0D" tabindex="0" >CONNECT</MSHelp:link> as the COM server, and it wraps and uses its interface <code>IRandom</code> and source interface <code>IRandomEvent</code> through <code>CoRandom</code> and <code>IRandomEvent_FireEventHandler</code> as if it was a .NET Framework event. The application creates multiple sinks to the <code>Fire</code> event of class <code>CoRandom</code> and controls the threads that the server creates.</p><div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left">Security Note </th></tr><tr><td><p>This sample code is provided to illustrate a concept and should not be used in applications or Web sites, as it may not illustrate the safest coding practices.</p></td></tr></table></div><h1 class="heading">Building and Running the Sample</h1><div id="sectionSection0" class="seeAlsoNoToggleSection"><h4 class="subHeading">To build and run MEDriver using Visual Studio</h4><div class="subSection"><ol><li><p>In the Visual Studio IDE, load the solution file MEDriver.sln.</p></li><li><p>In Solution Explorer, right-click the <b>MEDriver</b> solution.</p></li><li><p>On the shortcut menu, click <b>Build Solution</b>.</p></li><li><p>On the <b>Debug</b> menu, click <b>Start</b>.</p></li></ol></div><p>When you run MEDriver.exe, click the <b>Start</b> button at least once, and then click the <b>Advise</b> button several times. Each click of the <b>Advise</b> button adds a sink to the <b>Fire</b> event, which makes the display wider. If you do not click the <b>Advise</b> button, you will not see any activity in the display.</p></div><h1 class="heading">Keywords</h1><div id="sectionSection1" class="seeAlsoNoToggleSection"><p>This sample demonstrates the following keywords:</p><p>Control::CreateGraphics; Control::ClientRectangle; Graphics::DrawLine; Color::FromArgb; Mutex::WaitOne; Mutex::ReleaseMutex; Hashtable::Item; Application::Run; Button::Location; Button::Size; Button::Text; ControlCollection::AddRange</p></div></div><div id="footer"><div class="footerLine"></div>
          © Microsoft Corporation. All rights reserved.  Send <a href="mailto:DevDocs@microsoft.com?subject=Documentation Feedback :MEDriver Sample: Demonstrates COM Eventing in the .NET Framework">comments</a> about this topic to Microsoft.
      </div></div></body></html>
